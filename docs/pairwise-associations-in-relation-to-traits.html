<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader</title>
  <meta name="description" content="Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader" />
  <meta name="github-repo" content="pratikunterwegs/knot-association" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader" />
  
  <meta name="twitter:description" content="Section 10 Pairwise associations in relation to traits | Assortative association in a migratory Arctic wader" />
  

<meta name="author" content="Pratik R Gupte" />


<meta name="date" content="2020-07-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="finding-networks-from-patch-data-1.html"/>
<link rel="next" href="bathymetry-of-the-griend-mudflats.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-data.html"><a href="getting-data.html"><i class="fa fa-check"></i><b>2</b> Getting data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-data.html"><a href="getting-data.html#prepare-watlastools-and-other-libraries"><i class="fa fa-check"></i><b>2.1</b> Prepare <code>watlastools</code> and other libraries</a></li>
<li class="chapter" data-level="2.2" data-path="getting-data.html"><a href="getting-data.html#read-in-tag-deployment-data"><i class="fa fa-check"></i><b>2.2</b> Read in tag deployment data</a></li>
<li class="chapter" data-level="2.3" data-path="getting-data.html"><a href="getting-data.html#get-data-and-save-locally"><i class="fa fa-check"></i><b>2.3</b> Get data and save locally</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>3</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cleaning-data.html"><a href="cleaning-data.html#prepare-watlastools-and-other-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Prepare <code>watlastools</code> and other libraries</a></li>
<li class="chapter" data-level="3.2" data-path="cleaning-data.html"><a href="cleaning-data.html#prepare-to-remove-attractor-points"><i class="fa fa-check"></i><b>3.2</b> Prepare to remove attractor points</a></li>
<li class="chapter" data-level="3.3" data-path="cleaning-data.html"><a href="cleaning-data.html#read-clean-and-write-data"><i class="fa fa-check"></i><b>3.3</b> Read, clean, and write data</a></li>
<li class="chapter" data-level="3.4" data-path="cleaning-data.html"><a href="cleaning-data.html#tracking-period-for-each-id"><i class="fa fa-check"></i><b>3.4</b> Tracking period for each id</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="adding-tidal-cycle-data.html"><a href="adding-tidal-cycle-data.html"><i class="fa fa-check"></i><b>4</b> Adding tidal cycle data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="adding-tidal-cycle-data.html"><a href="adding-tidal-cycle-data.html#prepare-libraries"><i class="fa fa-check"></i><b>4.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="4.2" data-path="adding-tidal-cycle-data.html"><a href="adding-tidal-cycle-data.html#read-water-level-data"><i class="fa fa-check"></i><b>4.2</b> Read water level data</a></li>
<li class="chapter" data-level="4.3" data-path="adding-tidal-cycle-data.html"><a href="adding-tidal-cycle-data.html#calculate-high-tides"><i class="fa fa-check"></i><b>4.3</b> Calculate high tides</a></li>
<li class="chapter" data-level="4.4" data-path="adding-tidal-cycle-data.html"><a href="adding-tidal-cycle-data.html#add-time-since-high-tide"><i class="fa fa-check"></i><b>4.4</b> Add time since high tide</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="revisit-analysis.html"><a href="revisit-analysis.html"><i class="fa fa-check"></i><b>5</b> Revisit analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="revisit-analysis.html"><a href="revisit-analysis.html#prepare-libraries-1"><i class="fa fa-check"></i><b>5.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="5.2" data-path="revisit-analysis.html"><a href="revisit-analysis.html#read-data-split-recurse-write"><i class="fa fa-check"></i><b>5.2</b> Read data, split, recurse, write</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="residence-patch-construction.html"><a href="residence-patch-construction.html"><i class="fa fa-check"></i><b>6</b> Residence patch construction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="residence-patch-construction.html"><a href="residence-patch-construction.html#prepare-libraries-2"><i class="fa fa-check"></i><b>6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="6.2" data-path="residence-patch-construction.html"><a href="residence-patch-construction.html#patch-construction"><i class="fa fa-check"></i><b>6.2</b> Patch construction</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatio-temporal-overlap-in-patches.html"><a href="spatio-temporal-overlap-in-patches.html"><i class="fa fa-check"></i><b>7</b> Spatio-temporal overlap in patches</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatio-temporal-overlap-in-patches.html"><a href="spatio-temporal-overlap-in-patches.html#do-patches-overlap-in-time"><i class="fa fa-check"></i><b>7.1</b> Do patches overlap in time</a></li>
<li class="chapter" data-level="7.2" data-path="spatio-temporal-overlap-in-patches.html"><a href="spatio-temporal-overlap-in-patches.html#how-much-do-patches-overlap-in-time"><i class="fa fa-check"></i><b>7.2</b> How much do patches overlap in time?</a></li>
<li class="chapter" data-level="7.3" data-path="spatio-temporal-overlap-in-patches.html"><a href="spatio-temporal-overlap-in-patches.html#which-patches-overlap-in-space-and-where"><i class="fa fa-check"></i><b>7.3</b> Which patches overlap in space, and where?</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html"><i class="fa fa-check"></i><b>8</b> Finding networks from patch data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#read-in-patch-data-and-overlaps"><i class="fa fa-check"></i><b>8.1</b> Read in patch data and overlaps</a></li>
<li class="chapter" data-level="8.2" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#retain-extreme-individuals"><i class="fa fa-check"></i><b>8.2</b> Retain extreme individuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#read-in-trait-data"><i class="fa fa-check"></i><b>8.2.1</b> Read in trait data</a></li>
<li class="chapter" data-level="8.2.2" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#plot-histogram-of-traits"><i class="fa fa-check"></i><b>8.2.2</b> Plot histogram of traits</a></li>
<li class="chapter" data-level="8.2.3" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#keep-only-extreme-individuals"><i class="fa fa-check"></i><b>8.2.3</b> Keep only extreme individuals</a></li>
<li class="chapter" data-level="8.2.4" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#keep-only-extreme-individuals-patches"><i class="fa fa-check"></i><b>8.2.4</b> Keep only extreme individuals’ patches</a></li>
<li class="chapter" data-level="8.2.5" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#remove-patches-with-low-fixes"><i class="fa fa-check"></i><b>8.2.5</b> Remove patches with low fixes</a></li>
<li class="chapter" data-level="8.2.6" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#keep-only-extreme-ids-edges"><i class="fa fa-check"></i><b>8.2.6</b> Keep only extreme ids’ edges</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#network-construction"><i class="fa fa-check"></i><b>8.3</b> Network construction</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#make-unweighted-network-from-overlaps"><i class="fa fa-check"></i><b>8.3.1</b> Make <strong>unweighted</strong> network from overlaps</a></li>
<li class="chapter" data-level="8.3.2" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#find-communities"><i class="fa fa-check"></i><b>8.3.2</b> Find communities</a></li>
<li class="chapter" data-level="8.3.3" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#join-flock-data-to-edgelist"><i class="fa fa-check"></i><b>8.3.3</b> Join flock data to edgelist</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#prepare-network-data"><i class="fa fa-check"></i><b>8.4</b> Prepare network data</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#prepare-subset-wise-edgelist"><i class="fa fa-check"></i><b>8.4.1</b> Prepare subset-wise edgelist</a></li>
<li class="chapter" data-level="8.4.2" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#prepare-nodes-data"><i class="fa fa-check"></i><b>8.4.2</b> Prepare nodes data</a></li>
<li class="chapter" data-level="8.4.3" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#prepare-flock-networks"><i class="fa fa-check"></i><b>8.4.3</b> Prepare flock networks</a></li>
<li class="chapter" data-level="8.4.4" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#weigh-edges-by-number-of-overlaps"><i class="fa fa-check"></i><b>8.4.4</b> Weigh edges by number of overlaps</a></li>
<li class="chapter" data-level="8.4.5" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#make-networks"><i class="fa fa-check"></i><b>8.4.5</b> Make networks</a></li>
<li class="chapter" data-level="8.4.6" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#get-assortativity"><i class="fa fa-check"></i><b>8.4.6</b> Get assortativity</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#flock-attributes-and-assortativity"><i class="fa fa-check"></i><b>8.5</b> Flock attributes and assortativity</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#prepare-flock-data"><i class="fa fa-check"></i><b>8.5.1</b> Prepare flock data</a></li>
<li class="chapter" data-level="8.5.2" data-path="finding-networks-from-patch-data.html"><a href="finding-networks-from-patch-data.html#assortativity-in-high-and-low-tide"><i class="fa fa-check"></i><b>8.5.2</b> Assortativity in high and low tide</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html"><i class="fa fa-check"></i><b>9</b> Finding networks from patch data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#read-in-patch-data-and-overlaps-1"><i class="fa fa-check"></i><b>9.1</b> Read in patch data and overlaps</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#read-in-trait-data-1"><i class="fa fa-check"></i><b>9.1.1</b> Read in trait data</a></li>
<li class="chapter" data-level="9.1.2" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#filter-out-small-patches"><i class="fa fa-check"></i><b>9.1.2</b> Filter out small patches</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#overlaps-in-time-and-space"><i class="fa fa-check"></i><b>9.2</b> Overlaps in time and space</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#when-do-overlaps-happen"><i class="fa fa-check"></i><b>9.2.1</b> When do overlaps happen?</a></li>
<li class="chapter" data-level="9.2.2" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#where-do-overlaps-happen"><i class="fa fa-check"></i><b>9.2.2</b> Where do overlaps happen?</a></li>
<li class="chapter" data-level="9.2.3" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#where-and-when-do-overlaps-happen"><i class="fa fa-check"></i><b>9.2.3</b> Where AND when do overlaps happen?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#association-networks-based-on-space-time-overlap-subsets"><i class="fa fa-check"></i><b>9.3</b> Association networks based on space-time overlap subsets</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#prepare-subsets-of-data"><i class="fa fa-check"></i><b>9.3.1</b> Prepare subsets of data</a></li>
<li class="chapter" data-level="9.3.2" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#get-node-data"><i class="fa fa-check"></i><b>9.3.2</b> Get node data</a></li>
<li class="chapter" data-level="9.3.3" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#make-networks-using-the-edgelist-and-nodelist-joined-together."><i class="fa fa-check"></i><b>9.3.3</b> Make networks using the edgelist and nodelist joined together.</a></li>
<li class="chapter" data-level="9.3.4" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#remove-networks-with-few-edges"><i class="fa fa-check"></i><b>9.3.4</b> Remove networks with few edges</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#get-assortativity-1"><i class="fa fa-check"></i><b>9.4</b> Get assortativity</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#get-assortativity-on-node-attributes"><i class="fa fa-check"></i><b>9.4.1</b> Get assortativity on node attributes</a></li>
<li class="chapter" data-level="9.4.2" data-path="finding-networks-from-patch-data-1.html"><a href="finding-networks-from-patch-data-1.html#mean-assortativity-in-space-and-time"><i class="fa fa-check"></i><b>9.4.2</b> Mean assortativity in space and time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html"><i class="fa fa-check"></i><b>10</b> Pairwise associations in relation to traits</a>
<ul>
<li class="chapter" data-level="10.1" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#read-in-patch-data-and-overlaps-2"><i class="fa fa-check"></i><b>10.1</b> Read in patch data and overlaps</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#read-in-trait-data-2"><i class="fa fa-check"></i><b>10.1.1</b> Read in trait data</a></li>
<li class="chapter" data-level="10.1.2" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#what-is-the-empirical-distribution-of-differences-in-gizzard-mass"><i class="fa fa-check"></i><b>10.1.2</b> What is the empirical distribution of differences in gizzard mass?</a></li>
<li class="chapter" data-level="10.1.3" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#filter-out-small-patches-1"><i class="fa fa-check"></i><b>10.1.3</b> Filter out small patches</a></li>
<li class="chapter" data-level="10.1.4" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#link-patches-with-overlaps"><i class="fa fa-check"></i><b>10.1.4</b> Link patches with overlaps</a></li>
<li class="chapter" data-level="10.1.5" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#count-pairwise-overlaps"><i class="fa fa-check"></i><b>10.1.5</b> Count pairwise overlaps</a></li>
<li class="chapter" data-level="10.1.6" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#assign-unique-pair-ids"><i class="fa fa-check"></i><b>10.1.6</b> Assign unique pair ids</a></li>
<li class="chapter" data-level="10.1.7" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#subsample-for-even-coverage"><i class="fa fa-check"></i><b>10.1.7</b> Subsample for even coverage</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#statistical-modelling-of-number-of-associations"><i class="fa fa-check"></i><b>10.2</b> Statistical modelling of number of associations</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#fit-a-glmm-for-number-of-associations"><i class="fa fa-check"></i><b>10.2.1</b> Fit a GLMM for number of associations</a></li>
<li class="chapter" data-level="10.2.2" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#aic-comparison"><i class="fa fa-check"></i><b>10.2.2</b> AIC comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#statistical-modelling-of-spatial-overlap"><i class="fa fa-check"></i><b>10.3</b> Statistical modelling of spatial overlap</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#glmm-for-spatial-overlap"><i class="fa fa-check"></i><b>10.3.1</b> GLMM for spatial overlap</a></li>
<li class="chapter" data-level="10.3.2" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#aic-comparison-1"><i class="fa fa-check"></i><b>10.3.2</b> AIC comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#statistical-modelling-of-temporal-overlap"><i class="fa fa-check"></i><b>10.4</b> Statistical modelling of temporal overlap</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#glmm-for-temporal-overlap"><i class="fa fa-check"></i><b>10.4.1</b> GLMM for temporal overlap</a></li>
<li class="chapter" data-level="10.4.2" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#aic-and-r2-comparison"><i class="fa fa-check"></i><b>10.4.2</b> AIC and R<sup>2</sup> comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="pairwise-associations-in-relation-to-traits.html"><a href="pairwise-associations-in-relation-to-traits.html#save-data-to-file-for-network-analyses"><i class="fa fa-check"></i><b>10.5</b> Save data to file for network analyses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bathymetry-of-the-griend-mudflats.html"><a href="bathymetry-of-the-griend-mudflats.html"><i class="fa fa-check"></i><b>11</b> Bathymetry of the Griend mudflats</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bathymetry-of-the-griend-mudflats.html"><a href="bathymetry-of-the-griend-mudflats.html#get-data-and-plot-basic-trend"><i class="fa fa-check"></i><b>11.1</b> Get data and plot basic trend</a></li>
<li class="chapter" data-level="11.2" data-path="bathymetry-of-the-griend-mudflats.html"><a href="bathymetry-of-the-griend-mudflats.html#plot-as-3d-maps"><i class="fa fa-check"></i><b>11.2</b> Plot as 3D maps</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Assortative association in a migratory Arctic wader</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pairwise-associations-in-relation-to-traits" class="section level1">
<h1><span class="header-section-number">Section 10</span> Pairwise associations in relation to traits</h1>
<div id="read-in-patch-data-and-overlaps-2" class="section level2">
<h2><span class="header-section-number">10.1</span> Read in patch data and overlaps</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="pairwise-associations-in-relation-to-traits.html#cb62-1"></a><span class="co"># to handle data</span></span>
<span id="cb62-2"><a href="pairwise-associations-in-relation-to-traits.html#cb62-2"></a><span class="kw">library</span>(readr)</span>
<span id="cb62-3"><a href="pairwise-associations-in-relation-to-traits.html#cb62-3"></a><span class="kw">library</span>(scales)</span>
<span id="cb62-4"><a href="pairwise-associations-in-relation-to-traits.html#cb62-4"></a><span class="kw">library</span>(tidyr); <span class="kw">library</span>(tibble)</span>
<span id="cb62-5"><a href="pairwise-associations-in-relation-to-traits.html#cb62-5"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb62-6"><a href="pairwise-associations-in-relation-to-traits.html#cb62-6"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb62-7"><a href="pairwise-associations-in-relation-to-traits.html#cb62-7"></a><span class="kw">library</span>(purrr)</span>
<span id="cb62-8"><a href="pairwise-associations-in-relation-to-traits.html#cb62-8"></a><span class="kw">library</span>(stringr)</span>
<span id="cb62-9"><a href="pairwise-associations-in-relation-to-traits.html#cb62-9"></a><span class="kw">library</span>(forcats)</span>
<span id="cb62-10"><a href="pairwise-associations-in-relation-to-traits.html#cb62-10"></a></span>
<span id="cb62-11"><a href="pairwise-associations-in-relation-to-traits.html#cb62-11"></a><span class="co"># to work with networks</span></span>
<span id="cb62-12"><a href="pairwise-associations-in-relation-to-traits.html#cb62-12"></a><span class="kw">library</span>(igraph)</span>
<span id="cb62-13"><a href="pairwise-associations-in-relation-to-traits.html#cb62-13"></a></span>
<span id="cb62-14"><a href="pairwise-associations-in-relation-to-traits.html#cb62-14"></a><span class="co"># to plot</span></span>
<span id="cb62-15"><a href="pairwise-associations-in-relation-to-traits.html#cb62-15"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb62-16"><a href="pairwise-associations-in-relation-to-traits.html#cb62-16"></a><span class="kw">library</span>(scico)</span>
<span id="cb62-17"><a href="pairwise-associations-in-relation-to-traits.html#cb62-17"></a></span>
<span id="cb62-18"><a href="pairwise-associations-in-relation-to-traits.html#cb62-18"></a><span class="co"># functions</span></span>
<span id="cb62-19"><a href="pairwise-associations-in-relation-to-traits.html#cb62-19"></a>ci &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T)<span class="op">/</span><span class="kw">sqrt</span>((<span class="kw">length</span>(x)))}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="pairwise-associations-in-relation-to-traits.html#cb63-1"></a><span class="co"># read in patch data</span></span>
<span id="cb63-2"><a href="pairwise-associations-in-relation-to-traits.html#cb63-2"></a>data_patches &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/data2018/data_2018_patch_summary_has_patches.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb63-3"><a href="pairwise-associations-in-relation-to-traits.html#cb63-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">uid =</span> <span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.)))</span>
<span id="cb63-4"><a href="pairwise-associations-in-relation-to-traits.html#cb63-4"></a><span class="co"># read in overlap data</span></span>
<span id="cb63-5"><a href="pairwise-associations-in-relation-to-traits.html#cb63-5"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/data2018/data_spatio_temporal_overlap_2018.csv&quot;</span>)</span></code></pre></div>
<div id="read-in-trait-data-2" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Read in trait data</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="pairwise-associations-in-relation-to-traits.html#cb64-1"></a><span class="co"># make nodes data -- this the individual identities</span></span>
<span id="cb64-2"><a href="pairwise-associations-in-relation-to-traits.html#cb64-2"></a><span class="co"># add individual data to patch data</span></span>
<span id="cb64-3"><a href="pairwise-associations-in-relation-to-traits.html#cb64-3"></a>data_id &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="st">&quot;data/data2018/Biometrics_2018-2019.xlsx&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-4"><a href="pairwise-associations-in-relation-to-traits.html#cb64-4"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(<span class="st">`</span><span class="dt">TAG NR</span><span class="st">`</span>, <span class="st">&quot;[a-zA-Z]+&quot;</span>, <span class="dt">negate =</span> <span class="ot">TRUE</span>))</span>
<span id="cb64-5"><a href="pairwise-associations-in-relation-to-traits.html#cb64-5"></a></span>
<span id="cb64-6"><a href="pairwise-associations-in-relation-to-traits.html#cb64-6"></a><span class="co"># a function for gizzard mass</span></span>
<span id="cb64-7"><a href="pairwise-associations-in-relation-to-traits.html#cb64-7"></a>get_gizzard_mass &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {<span class="op">-</span><span class="fl">1.09</span> <span class="op">+</span><span class="st"> </span>(<span class="fl">3.78</span><span class="op">*</span>(x<span class="op">*</span>y))}</span>
<span id="cb64-8"><a href="pairwise-associations-in-relation-to-traits.html#cb64-8"></a></span>
<span id="cb64-9"><a href="pairwise-associations-in-relation-to-traits.html#cb64-9"></a><span class="co"># add gizzard mass</span></span>
<span id="cb64-10"><a href="pairwise-associations-in-relation-to-traits.html#cb64-10"></a>data_id &lt;-<span class="st"> </span><span class="kw">mutate</span>(data_id,</span>
<span id="cb64-11"><a href="pairwise-associations-in-relation-to-traits.html#cb64-11"></a>                  <span class="dt">gizzard_mass =</span> <span class="kw">get_gizzard_mass</span>(SH1, SW1))</span>
<span id="cb64-12"><a href="pairwise-associations-in-relation-to-traits.html#cb64-12"></a></span>
<span id="cb64-13"><a href="pairwise-associations-in-relation-to-traits.html#cb64-13"></a><span class="co"># rename columns and drop ids without mass and gizzard mass</span></span>
<span id="cb64-14"><a href="pairwise-associations-in-relation-to-traits.html#cb64-14"></a>data_id &lt;-<span class="st"> </span>data_id <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-15"><a href="pairwise-associations-in-relation-to-traits.html#cb64-15"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">id =</span> <span class="st">`</span><span class="dt">TAG NR</span><span class="st">`</span>, </span>
<span id="cb64-16"><a href="pairwise-associations-in-relation-to-traits.html#cb64-16"></a>         <span class="dt">wing =</span> WING, <span class="dt">mass =</span> MASS, </span>
<span id="cb64-17"><a href="pairwise-associations-in-relation-to-traits.html#cb64-17"></a>         gizzard_mass) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-18"><a href="pairwise-associations-in-relation-to-traits.html#cb64-18"></a><span class="st">  </span><span class="kw">distinct</span>(id, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-19"><a href="pairwise-associations-in-relation-to-traits.html#cb64-19"></a><span class="st">  </span><span class="kw">drop_na</span>(gizzard_mass)</span>
<span id="cb64-20"><a href="pairwise-associations-in-relation-to-traits.html#cb64-20"></a></span>
<span id="cb64-21"><a href="pairwise-associations-in-relation-to-traits.html#cb64-21"></a><span class="co"># add some exploration scores and tag info</span></span>
<span id="cb64-22"><a href="pairwise-associations-in-relation-to-traits.html#cb64-22"></a>data_behav &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/data2018/2018-19-all_exploration_scores.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-23"><a href="pairwise-associations-in-relation-to-traits.html#cb64-23"></a><span class="st">  </span><span class="kw">filter</span>(Exp <span class="op">==</span><span class="st"> &quot;F01&quot;</span>)</span>
<span id="cb64-24"><a href="pairwise-associations-in-relation-to-traits.html#cb64-24"></a>data_tag &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/data2018/tag_info.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-25"><a href="pairwise-associations-in-relation-to-traits.html#cb64-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">as.character</span>(Toa_Tag))</span>
<span id="cb64-26"><a href="pairwise-associations-in-relation-to-traits.html#cb64-26"></a></span>
<span id="cb64-27"><a href="pairwise-associations-in-relation-to-traits.html#cb64-27"></a><span class="co"># join all scores</span></span>
<span id="cb64-28"><a href="pairwise-associations-in-relation-to-traits.html#cb64-28"></a>data_id &lt;-<span class="st"> </span><span class="kw">left_join</span>(data_id, data_tag,</span>
<span id="cb64-29"><a href="pairwise-associations-in-relation-to-traits.html#cb64-29"></a>                     <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-30"><a href="pairwise-associations-in-relation-to-traits.html#cb64-30"></a><span class="st">  </span><span class="kw">left_join</span>(data_behav, <span class="dt">by =</span> <span class="st">&quot;FB&quot;</span>)</span>
<span id="cb64-31"><a href="pairwise-associations-in-relation-to-traits.html#cb64-31"></a></span>
<span id="cb64-32"><a href="pairwise-associations-in-relation-to-traits.html#cb64-32"></a><span class="co"># remove ids with no exploration</span></span>
<span id="cb64-33"><a href="pairwise-associations-in-relation-to-traits.html#cb64-33"></a>data_id &lt;-<span class="st"> </span><span class="kw">mutate</span>(data_id,</span>
<span id="cb64-34"><a href="pairwise-associations-in-relation-to-traits.html#cb64-34"></a>                  <span class="dt">behav =</span> Mean) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-35"><a href="pairwise-associations-in-relation-to-traits.html#cb64-35"></a><span class="st">  </span><span class="co"># drop_na(behav) %&gt;% </span></span>
<span id="cb64-36"><a href="pairwise-associations-in-relation-to-traits.html#cb64-36"></a><span class="st">  </span><span class="kw">select</span>(id, mass, gizzard_mass, behav)</span></code></pre></div>
</div>
<div id="what-is-the-empirical-distribution-of-differences-in-gizzard-mass" class="section level3">
<h3><span class="header-section-number">10.1.2</span> What is the empirical distribution of differences in gizzard mass?</h3>
</div>
<div id="filter-out-small-patches-1" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Filter out small patches</h3>
<p>Each fix corresponds to 30s time.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="pairwise-associations-in-relation-to-traits.html#cb65-1"></a>data_patches &lt;-<span class="st"> </span><span class="kw">filter</span>(data_patches,</span>
<span id="cb65-2"><a href="pairwise-associations-in-relation-to-traits.html#cb65-2"></a>                       nfixes <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb65-3"><a href="pairwise-associations-in-relation-to-traits.html#cb65-3"></a></span>
<span id="cb65-4"><a href="pairwise-associations-in-relation-to-traits.html#cb65-4"></a>data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-5"><a href="pairwise-associations-in-relation-to-traits.html#cb65-5"></a><span class="st">  </span><span class="kw">filter</span>(patch_i_unique_id <span class="op">%in%</span><span class="st"> </span>data_patches<span class="op">$</span>uid,</span>
<span id="cb65-6"><a href="pairwise-associations-in-relation-to-traits.html#cb65-6"></a>         patch_j_unique_id <span class="op">%in%</span><span class="st"> </span>data_patches<span class="op">$</span>uid)</span></code></pre></div>
</div>
<div id="link-patches-with-overlaps" class="section level3">
<h3><span class="header-section-number">10.1.4</span> Link patches with overlaps</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="pairwise-associations-in-relation-to-traits.html#cb66-1"></a><span class="co"># convert to character</span></span>
<span id="cb66-2"><a href="pairwise-associations-in-relation-to-traits.html#cb66-2"></a>data &lt;-<span class="st"> </span><span class="kw">mutate_at</span>(data, <span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;patch&quot;</span>)), as.character)</span>
<span id="cb66-3"><a href="pairwise-associations-in-relation-to-traits.html#cb66-3"></a>data &lt;-<span class="st"> </span><span class="kw">left_join</span>(data, data_patches,</span>
<span id="cb66-4"><a href="pairwise-associations-in-relation-to-traits.html#cb66-4"></a>                  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;patch_i_unique_id&quot;</span> =<span class="st"> &quot;uid&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-5"><a href="pairwise-associations-in-relation-to-traits.html#cb66-5"></a><span class="st">  </span><span class="kw">left_join</span>(data_patches,</span>
<span id="cb66-6"><a href="pairwise-associations-in-relation-to-traits.html#cb66-6"></a>            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;patch_j_unique_id&quot;</span> =<span class="st"> &quot;uid&quot;</span>))</span></code></pre></div>
</div>
<div id="count-pairwise-overlaps" class="section level3">
<h3><span class="header-section-number">10.1.5</span> Count pairwise overlaps</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="pairwise-associations-in-relation-to-traits.html#cb67-1"></a><span class="co"># first clip data into 3 sections with lims at 0, 55</span></span>
<span id="cb67-2"><a href="pairwise-associations-in-relation-to-traits.html#cb67-2"></a>data_summary &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></span>
<span id="cb67-3"><a href="pairwise-associations-in-relation-to-traits.html#cb67-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tide_number =</span> tide_number.x,</span>
<span id="cb67-4"><a href="pairwise-associations-in-relation-to-traits.html#cb67-4"></a>         <span class="dt">waterlevel =</span> waterlevel_start.x,</span>
<span id="cb67-5"><a href="pairwise-associations-in-relation-to-traits.html#cb67-5"></a>         <span class="dt">tide_stage =</span> <span class="kw">case_when</span>(waterlevel <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;low&quot;</span>,</span>
<span id="cb67-6"><a href="pairwise-associations-in-relation-to-traits.html#cb67-6"></a>                                <span class="co"># between(waterlevel, 0, 55) ~ &quot;medium&quot;,</span></span>
<span id="cb67-7"><a href="pairwise-associations-in-relation-to-traits.html#cb67-7"></a>                                waterlevel <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;high&quot;</span>,</span>
<span id="cb67-8"><a href="pairwise-associations-in-relation-to-traits.html#cb67-8"></a>                                T <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-9"><a href="pairwise-associations-in-relation-to-traits.html#cb67-9"></a><span class="st">  </span></span>
<span id="cb67-10"><a href="pairwise-associations-in-relation-to-traits.html#cb67-10"></a><span class="st">  </span><span class="co"># count as well as add strength in terms of space and time</span></span>
<span id="cb67-11"><a href="pairwise-associations-in-relation-to-traits.html#cb67-11"></a><span class="st">  </span><span class="kw">group_by</span>(id.x, id.y, tide_number, tide_stage) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-12"><a href="pairwise-associations-in-relation-to-traits.html#cb67-12"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_associations =</span> <span class="kw">length</span>(spatial_overlap_area),</span>
<span id="cb67-13"><a href="pairwise-associations-in-relation-to-traits.html#cb67-13"></a>            <span class="dt">tot_overlap_space =</span> <span class="kw">sum</span>(spatial_overlap_area),</span>
<span id="cb67-14"><a href="pairwise-associations-in-relation-to-traits.html#cb67-14"></a>            <span class="dt">tot_overlap_time =</span> <span class="kw">sum</span>(temporal_overlap_seconds)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-15"><a href="pairwise-associations-in-relation-to-traits.html#cb67-15"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="pairwise-associations-in-relation-to-traits.html#cb68-1"></a><span class="co"># link trait values</span></span>
<span id="cb68-2"><a href="pairwise-associations-in-relation-to-traits.html#cb68-2"></a>data_summary &lt;-<span class="st"> </span><span class="kw">mutate_at</span>(data_summary,</span>
<span id="cb68-3"><a href="pairwise-associations-in-relation-to-traits.html#cb68-3"></a>                          <span class="kw">vars</span>(<span class="kw">matches</span>(<span class="st">&quot;id&quot;</span>)),</span>
<span id="cb68-4"><a href="pairwise-associations-in-relation-to-traits.html#cb68-4"></a>                          as.character)</span>
<span id="cb68-5"><a href="pairwise-associations-in-relation-to-traits.html#cb68-5"></a>data_summary &lt;-<span class="st"> </span><span class="kw">left_join</span>(data_summary,</span>
<span id="cb68-6"><a href="pairwise-associations-in-relation-to-traits.html#cb68-6"></a>                          data_id,</span>
<span id="cb68-7"><a href="pairwise-associations-in-relation-to-traits.html#cb68-7"></a>                          <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id.x&quot;</span> =<span class="st"> &quot;id&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-8"><a href="pairwise-associations-in-relation-to-traits.html#cb68-8"></a><span class="st">  </span><span class="kw">left_join</span>(data_id,</span>
<span id="cb68-9"><a href="pairwise-associations-in-relation-to-traits.html#cb68-9"></a>            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id.y&quot;</span> =<span class="st"> &quot;id&quot;</span>))</span>
<span id="cb68-10"><a href="pairwise-associations-in-relation-to-traits.html#cb68-10"></a></span>
<span id="cb68-11"><a href="pairwise-associations-in-relation-to-traits.html#cb68-11"></a><span class="co"># get difference in traits</span></span>
<span id="cb68-12"><a href="pairwise-associations-in-relation-to-traits.html#cb68-12"></a>data_summary &lt;-<span class="st"> </span>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-13"><a href="pairwise-associations-in-relation-to-traits.html#cb68-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff_gizzard =</span> <span class="kw">abs</span>(gizzard_mass.x <span class="op">-</span><span class="st"> </span>gizzard_mass.y),</span>
<span id="cb68-14"><a href="pairwise-associations-in-relation-to-traits.html#cb68-14"></a>         <span class="dt">diff_gizzard_round =</span> plyr<span class="op">::</span><span class="kw">round_any</span>(diff_gizzard, <span class="fl">0.5</span>),</span>
<span id="cb68-15"><a href="pairwise-associations-in-relation-to-traits.html#cb68-15"></a>         <span class="dt">diff_behav =</span> <span class="kw">abs</span>(behav.x <span class="op">-</span><span class="st"> </span>behav.y),</span>
<span id="cb68-16"><a href="pairwise-associations-in-relation-to-traits.html#cb68-16"></a>         <span class="dt">tide_stage =</span> forcats<span class="op">::</span><span class="kw">as_factor</span>(tide_stage),</span>
<span id="cb68-17"><a href="pairwise-associations-in-relation-to-traits.html#cb68-17"></a>         <span class="dt">tide_stage =</span> <span class="kw">fct_relevel</span>(tide_stage,</span>
<span id="cb68-18"><a href="pairwise-associations-in-relation-to-traits.html#cb68-18"></a>                                  <span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-19"><a href="pairwise-associations-in-relation-to-traits.html#cb68-19"></a><span class="st">  </span><span class="kw">drop_na</span>(diff_gizzard)</span></code></pre></div>
</div>
<div id="assign-unique-pair-ids" class="section level3">
<h3><span class="header-section-number">10.1.6</span> Assign unique pair ids</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="pairwise-associations-in-relation-to-traits.html#cb69-1"></a><span class="co"># count the number of data in each class</span></span>
<span id="cb69-2"><a href="pairwise-associations-in-relation-to-traits.html#cb69-2"></a>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-3"><a href="pairwise-associations-in-relation-to-traits.html#cb69-3"></a><span class="st">  </span><span class="kw">count</span>(diff_gizzard_round)</span>
<span id="cb69-4"><a href="pairwise-associations-in-relation-to-traits.html#cb69-4"></a></span>
<span id="cb69-5"><a href="pairwise-associations-in-relation-to-traits.html#cb69-5"></a><span class="co"># count the difference in gizzards per pairwise association</span></span>
<span id="cb69-6"><a href="pairwise-associations-in-relation-to-traits.html#cb69-6"></a>data_summary &lt;-<span class="st"> </span>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-7"><a href="pairwise-associations-in-relation-to-traits.html#cb69-7"></a><span class="st">  </span><span class="kw">group_by</span>(id.x, id.y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-8"><a href="pairwise-associations-in-relation-to-traits.html#cb69-8"></a><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-9"><a href="pairwise-associations-in-relation-to-traits.html#cb69-9"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-10"><a href="pairwise-associations-in-relation-to-traits.html#cb69-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">uid_pair =</span> <span class="kw">seq_len</span>(<span class="kw">nrow</span>(.)))</span>
<span id="cb69-11"><a href="pairwise-associations-in-relation-to-traits.html#cb69-11"></a></span>
<span id="cb69-12"><a href="pairwise-associations-in-relation-to-traits.html#cb69-12"></a><span class="co"># then unnest</span></span>
<span id="cb69-13"><a href="pairwise-associations-in-relation-to-traits.html#cb69-13"></a>data_summary &lt;-<span class="st"> </span><span class="kw">unnest</span>(data_summary,</span>
<span id="cb69-14"><a href="pairwise-associations-in-relation-to-traits.html#cb69-14"></a>                       <span class="dt">col =</span> <span class="st">&quot;data&quot;</span>)</span></code></pre></div>
</div>
<div id="subsample-for-even-coverage" class="section level3">
<h3><span class="header-section-number">10.1.7</span> Subsample for even coverage</h3>
<p>Small gizzard mass differences are over-represented as expected from a population with normally distributed traits. This requires subsampling based on difference bins.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="pairwise-associations-in-relation-to-traits.html#cb70-1"></a><span class="co"># filter for differences above 5 and subsample as many</span></span>
<span id="cb70-2"><a href="pairwise-associations-in-relation-to-traits.html#cb70-2"></a><span class="co"># as supported</span></span>
<span id="cb70-3"><a href="pairwise-associations-in-relation-to-traits.html#cb70-3"></a>data_subsample &lt;-<span class="st"> </span>data_summary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-4"><a href="pairwise-associations-in-relation-to-traits.html#cb70-4"></a><span class="st">  </span><span class="kw">filter</span>(diff_gizzard_round <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-5"><a href="pairwise-associations-in-relation-to-traits.html#cb70-5"></a><span class="st">  </span><span class="kw">group_by</span>(tide_stage, diff_gizzard_round) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-6"><a href="pairwise-associations-in-relation-to-traits.html#cb70-6"></a><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span></span>
<span id="cb70-7"><a href="pairwise-associations-in-relation-to-traits.html#cb70-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">map</span>(data, <span class="cf">function</span>(x) x[<span class="dv">1</span><span class="op">:</span><span class="dv">1480</span>,])) <span class="co"># this is hardcoded</span></span>
<span id="cb70-8"><a href="pairwise-associations-in-relation-to-traits.html#cb70-8"></a></span>
<span id="cb70-9"><a href="pairwise-associations-in-relation-to-traits.html#cb70-9"></a><span class="co"># unnest</span></span>
<span id="cb70-10"><a href="pairwise-associations-in-relation-to-traits.html#cb70-10"></a>data_subsample &lt;-<span class="st"> </span><span class="kw">unnest</span>(data_subsample, <span class="dt">cols =</span> <span class="st">&quot;data&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="statistical-modelling-of-number-of-associations" class="section level2">
<h2><span class="header-section-number">10.2</span> Statistical modelling of number of associations</h2>
<div id="fit-a-glmm-for-number-of-associations" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Fit a GLMM for number of associations</h3>
<p>Difference in gizzard mass and behaviour score are predictors.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="pairwise-associations-in-relation-to-traits.html#cb71-1"></a><span class="co"># run a single canonical model</span></span>
<span id="cb71-2"><a href="pairwise-associations-in-relation-to-traits.html#cb71-2"></a><span class="kw">library</span>(lmerTest)</span>
<span id="cb71-3"><a href="pairwise-associations-in-relation-to-traits.html#cb71-3"></a>model_n_assoc_full &lt;-<span class="st"> </span><span class="kw">glmer</span>(n_associations <span class="op">~</span><span class="st"> </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb71-4"><a href="pairwise-associations-in-relation-to-traits.html#cb71-4"></a><span class="st">                         </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb71-5"><a href="pairwise-associations-in-relation-to-traits.html#cb71-5"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb71-6"><a href="pairwise-associations-in-relation-to-traits.html#cb71-6"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb71-7"><a href="pairwise-associations-in-relation-to-traits.html#cb71-7"></a>                       <span class="dt">data =</span> data_subsample,</span>
<span id="cb71-8"><a href="pairwise-associations-in-relation-to-traits.html#cb71-8"></a>                       <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb71-9"><a href="pairwise-associations-in-relation-to-traits.html#cb71-9"></a></span>
<span id="cb71-10"><a href="pairwise-associations-in-relation-to-traits.html#cb71-10"></a><span class="co"># run an alternative model with only behaviour</span></span>
<span id="cb71-11"><a href="pairwise-associations-in-relation-to-traits.html#cb71-11"></a>model_n_assoc_behav_only &lt;-<span class="st"> </span><span class="kw">glmer</span>(n_associations <span class="op">~</span><span class="st"> </span></span>
<span id="cb71-12"><a href="pairwise-associations-in-relation-to-traits.html#cb71-12"></a><span class="st">                                 </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb71-13"><a href="pairwise-associations-in-relation-to-traits.html#cb71-13"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb71-14"><a href="pairwise-associations-in-relation-to-traits.html#cb71-14"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb71-15"><a href="pairwise-associations-in-relation-to-traits.html#cb71-15"></a>                               <span class="dt">data =</span> data_subsample,</span>
<span id="cb71-16"><a href="pairwise-associations-in-relation-to-traits.html#cb71-16"></a>                               <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb71-17"><a href="pairwise-associations-in-relation-to-traits.html#cb71-17"></a></span>
<span id="cb71-18"><a href="pairwise-associations-in-relation-to-traits.html#cb71-18"></a><span class="co"># an alternative model with only gizzard mass</span></span>
<span id="cb71-19"><a href="pairwise-associations-in-relation-to-traits.html#cb71-19"></a>model_n_assoc_gizzard_only &lt;-<span class="st"> </span><span class="kw">glmer</span>(n_associations <span class="op">~</span><span class="st"> </span></span>
<span id="cb71-20"><a href="pairwise-associations-in-relation-to-traits.html#cb71-20"></a><span class="st">                                 </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb71-21"><a href="pairwise-associations-in-relation-to-traits.html#cb71-21"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb71-22"><a href="pairwise-associations-in-relation-to-traits.html#cb71-22"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb71-23"><a href="pairwise-associations-in-relation-to-traits.html#cb71-23"></a>                               <span class="dt">data =</span> data_subsample,</span>
<span id="cb71-24"><a href="pairwise-associations-in-relation-to-traits.html#cb71-24"></a>                               <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span></code></pre></div>
</div>
<div id="aic-comparison" class="section level3">
<h3><span class="header-section-number">10.2.2</span> AIC comparison</h3>
<p>Compare the AIC weights after looking at the model summaries.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="pairwise-associations-in-relation-to-traits.html#cb72-1"></a><span class="kw">summary</span>(model_n_assoc_full)</span>
<span id="cb72-2"><a href="pairwise-associations-in-relation-to-traits.html#cb72-2"></a></span>
<span id="cb72-3"><a href="pairwise-associations-in-relation-to-traits.html#cb72-3"></a><span class="kw">summary</span>(model_n_assoc_behav_only)</span>
<span id="cb72-4"><a href="pairwise-associations-in-relation-to-traits.html#cb72-4"></a></span>
<span id="cb72-5"><a href="pairwise-associations-in-relation-to-traits.html#cb72-5"></a><span class="kw">summary</span>(model_n_assoc_gizzard_only)</span></code></pre></div>
<p>It seems that differences in behaviour as well as gizzard mass are each sufficient sufficient to explain the observed number of overlaps. Examine the AIC scores.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="pairwise-associations-in-relation-to-traits.html#cb73-1"></a><span class="co"># get aic difference</span></span>
<span id="cb73-2"><a href="pairwise-associations-in-relation-to-traits.html#cb73-2"></a><span class="kw">map_dbl</span>(<span class="kw">list</span>(<span class="dt">behaviour_only =</span> model_n_assoc_behav_only, </span>
<span id="cb73-3"><a href="pairwise-associations-in-relation-to-traits.html#cb73-3"></a>         <span class="dt">gizzard_only =</span> model_n_assoc_gizzard_only, </span>
<span id="cb73-4"><a href="pairwise-associations-in-relation-to-traits.html#cb73-4"></a>         <span class="dt">gizzard_and_behav =</span> model_n_assoc_full),</span>
<span id="cb73-5"><a href="pairwise-associations-in-relation-to-traits.html#cb73-5"></a>    AIC)</span></code></pre></div>
<p>With similar AIC scores and R<sup>2</sup> values, we select the reduced model by the parsimony principle, and write the model output to file.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="pairwise-associations-in-relation-to-traits.html#cb74-1"></a>model_output =<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">map</span>(<span class="kw">list</span>(<span class="dt">behaviour_only =</span> model_n_assoc_behav_only, </span>
<span id="cb74-2"><a href="pairwise-associations-in-relation-to-traits.html#cb74-2"></a>                                       <span class="dt">gizzard_only =</span> model_n_assoc_gizzard_only, </span>
<span id="cb74-3"><a href="pairwise-associations-in-relation-to-traits.html#cb74-3"></a>                                       <span class="dt">gizzard_and_behav =</span> model_n_assoc_full),</span>
<span id="cb74-4"><a href="pairwise-associations-in-relation-to-traits.html#cb74-4"></a>                                  summary))</span>
<span id="cb74-5"><a href="pairwise-associations-in-relation-to-traits.html#cb74-5"></a></span>
<span id="cb74-6"><a href="pairwise-associations-in-relation-to-traits.html#cb74-6"></a><span class="co"># save it to file</span></span>
<span id="cb74-7"><a href="pairwise-associations-in-relation-to-traits.html#cb74-7"></a><span class="kw">write_lines</span>(<span class="dt">x =</span> model_output, <span class="dt">path =</span> <span class="st">&quot;results/model_n_assoc.txt&quot;</span>)</span></code></pre></div>
<p>Read in the model and print summary.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="pairwise-associations-in-relation-to-traits.html#cb75-1"></a><span class="kw">cat</span>(<span class="kw">read_lines</span>(<span class="st">&quot;results/model_n_assoc.txt&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="statistical-modelling-of-spatial-overlap" class="section level2">
<h2><span class="header-section-number">10.3</span> Statistical modelling of spatial overlap</h2>
<div id="glmm-for-spatial-overlap" class="section level3">
<h3><span class="header-section-number">10.3.1</span> GLMM for spatial overlap</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="pairwise-associations-in-relation-to-traits.html#cb76-1"></a><span class="co"># run a model with overlap as the response</span></span>
<span id="cb76-2"><a href="pairwise-associations-in-relation-to-traits.html#cb76-2"></a><span class="kw">library</span>(lmerTest)</span>
<span id="cb76-3"><a href="pairwise-associations-in-relation-to-traits.html#cb76-3"></a>model_sp_overlap_full &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_space <span class="op">~</span><span class="st"> </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb76-4"><a href="pairwise-associations-in-relation-to-traits.html#cb76-4"></a><span class="st">                         </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb76-5"><a href="pairwise-associations-in-relation-to-traits.html#cb76-5"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb76-6"><a href="pairwise-associations-in-relation-to-traits.html#cb76-6"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb76-7"><a href="pairwise-associations-in-relation-to-traits.html#cb76-7"></a>                       <span class="dt">data =</span> data_subsample)</span>
<span id="cb76-8"><a href="pairwise-associations-in-relation-to-traits.html#cb76-8"></a></span>
<span id="cb76-9"><a href="pairwise-associations-in-relation-to-traits.html#cb76-9"></a><span class="co"># run an alternative model with only behaviour</span></span>
<span id="cb76-10"><a href="pairwise-associations-in-relation-to-traits.html#cb76-10"></a>model_sp_overlap_behav_only &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_space <span class="op">~</span><span class="st"> </span></span>
<span id="cb76-11"><a href="pairwise-associations-in-relation-to-traits.html#cb76-11"></a><span class="st">                                 </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb76-12"><a href="pairwise-associations-in-relation-to-traits.html#cb76-12"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb76-13"><a href="pairwise-associations-in-relation-to-traits.html#cb76-13"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb76-14"><a href="pairwise-associations-in-relation-to-traits.html#cb76-14"></a>                               <span class="dt">data =</span> data_subsample)</span>
<span id="cb76-15"><a href="pairwise-associations-in-relation-to-traits.html#cb76-15"></a></span>
<span id="cb76-16"><a href="pairwise-associations-in-relation-to-traits.html#cb76-16"></a><span class="co"># an alternative model with only gizzard mass</span></span>
<span id="cb76-17"><a href="pairwise-associations-in-relation-to-traits.html#cb76-17"></a>model_sp_overlap_gizzard_only &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_space <span class="op">~</span><span class="st"> </span></span>
<span id="cb76-18"><a href="pairwise-associations-in-relation-to-traits.html#cb76-18"></a><span class="st">                                 </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb76-19"><a href="pairwise-associations-in-relation-to-traits.html#cb76-19"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb76-20"><a href="pairwise-associations-in-relation-to-traits.html#cb76-20"></a><span class="st">                                 </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb76-21"><a href="pairwise-associations-in-relation-to-traits.html#cb76-21"></a>                               <span class="dt">data =</span> data_subsample)</span></code></pre></div>
</div>
<div id="aic-comparison-1" class="section level3">
<h3><span class="header-section-number">10.3.2</span> AIC comparison</h3>
<p>Compare the AIC weights after looking at the model summaries.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="pairwise-associations-in-relation-to-traits.html#cb77-1"></a><span class="kw">summary</span>(model_sp_overlap_full)</span>
<span id="cb77-2"><a href="pairwise-associations-in-relation-to-traits.html#cb77-2"></a></span>
<span id="cb77-3"><a href="pairwise-associations-in-relation-to-traits.html#cb77-3"></a><span class="kw">summary</span>(model_sp_overlap_behav_only)</span>
<span id="cb77-4"><a href="pairwise-associations-in-relation-to-traits.html#cb77-4"></a></span>
<span id="cb77-5"><a href="pairwise-associations-in-relation-to-traits.html#cb77-5"></a><span class="kw">summary</span>(model_sp_overlap_gizzard_only)</span></code></pre></div>
<p>It seems that differences in behaviour are sufficient in this case to explain the observed extent of overlaps. Examine the AIC scores.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="pairwise-associations-in-relation-to-traits.html#cb78-1"></a><span class="co"># get aic difference</span></span>
<span id="cb78-2"><a href="pairwise-associations-in-relation-to-traits.html#cb78-2"></a><span class="kw">map_dbl</span>(<span class="kw">list</span>(<span class="dt">behaviour_only =</span> model_sp_overlap_behav_only, </span>
<span id="cb78-3"><a href="pairwise-associations-in-relation-to-traits.html#cb78-3"></a>         <span class="dt">gizzard_only =</span> model_sp_overlap_gizzard_only, </span>
<span id="cb78-4"><a href="pairwise-associations-in-relation-to-traits.html#cb78-4"></a>         <span class="dt">gizzard_and_behav =</span> model_sp_overlap_full),</span>
<span id="cb78-5"><a href="pairwise-associations-in-relation-to-traits.html#cb78-5"></a>    AIC)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="pairwise-associations-in-relation-to-traits.html#cb79-1"></a>model_output =<span class="st"> </span><span class="kw">capture.output</span>(<span class="kw">map</span>(<span class="kw">list</span>(<span class="dt">behaviour_only =</span> model_sp_overlap_behav_only, </span>
<span id="cb79-2"><a href="pairwise-associations-in-relation-to-traits.html#cb79-2"></a>                                       <span class="dt">gizzard_only =</span> model_sp_overlap_gizzard_only, </span>
<span id="cb79-3"><a href="pairwise-associations-in-relation-to-traits.html#cb79-3"></a>                                       <span class="dt">gizzard_and_behav =</span> model_sp_overlap_full),</span>
<span id="cb79-4"><a href="pairwise-associations-in-relation-to-traits.html#cb79-4"></a>                                  summary))</span>
<span id="cb79-5"><a href="pairwise-associations-in-relation-to-traits.html#cb79-5"></a></span>
<span id="cb79-6"><a href="pairwise-associations-in-relation-to-traits.html#cb79-6"></a><span class="co"># save it to file</span></span>
<span id="cb79-7"><a href="pairwise-associations-in-relation-to-traits.html#cb79-7"></a><span class="kw">write_lines</span>(<span class="dt">x =</span> model_output, <span class="dt">path =</span> <span class="st">&quot;results/model_sp_overlap.txt&quot;</span>)</span></code></pre></div>
<p>Read in the model summary and write.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="pairwise-associations-in-relation-to-traits.html#cb80-1"></a><span class="kw">cat</span>(<span class="kw">read_lines</span>(<span class="st">&quot;results/model_sp_overlap.txt&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="statistical-modelling-of-temporal-overlap" class="section level2">
<h2><span class="header-section-number">10.4</span> Statistical modelling of temporal overlap</h2>
<div id="glmm-for-temporal-overlap" class="section level3">
<h3><span class="header-section-number">10.4.1</span> GLMM for temporal overlap</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="pairwise-associations-in-relation-to-traits.html#cb81-1"></a><span class="co"># run a model with overlap as the response</span></span>
<span id="cb81-2"><a href="pairwise-associations-in-relation-to-traits.html#cb81-2"></a><span class="kw">library</span>(lmerTest)</span>
<span id="cb81-3"><a href="pairwise-associations-in-relation-to-traits.html#cb81-3"></a>model_time_overlap_full &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_time <span class="op">~</span><span class="st"> </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb81-4"><a href="pairwise-associations-in-relation-to-traits.html#cb81-4"></a><span class="st">                         </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb81-5"><a href="pairwise-associations-in-relation-to-traits.html#cb81-5"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb81-6"><a href="pairwise-associations-in-relation-to-traits.html#cb81-6"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb81-7"><a href="pairwise-associations-in-relation-to-traits.html#cb81-7"></a>                       <span class="dt">data =</span> data_subsample)</span>
<span id="cb81-8"><a href="pairwise-associations-in-relation-to-traits.html#cb81-8"></a></span>
<span id="cb81-9"><a href="pairwise-associations-in-relation-to-traits.html#cb81-9"></a><span class="co"># run an alternative model with only behaviour</span></span>
<span id="cb81-10"><a href="pairwise-associations-in-relation-to-traits.html#cb81-10"></a>model_time_overlap_behav_only &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_time <span class="op">~</span><span class="st"> </span></span>
<span id="cb81-11"><a href="pairwise-associations-in-relation-to-traits.html#cb81-11"></a><span class="st">                         </span>diff_behav <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb81-12"><a href="pairwise-associations-in-relation-to-traits.html#cb81-12"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb81-13"><a href="pairwise-associations-in-relation-to-traits.html#cb81-13"></a><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb81-14"><a href="pairwise-associations-in-relation-to-traits.html#cb81-14"></a>                       <span class="dt">data =</span> data_subsample)</span>
<span id="cb81-15"><a href="pairwise-associations-in-relation-to-traits.html#cb81-15"></a></span>
<span id="cb81-16"><a href="pairwise-associations-in-relation-to-traits.html#cb81-16"></a><span class="co"># only gizzard</span></span>
<span id="cb81-17"><a href="pairwise-associations-in-relation-to-traits.html#cb81-17"></a>model_time_overlap_gizzard_only &lt;-<span class="st"> </span><span class="kw">lmer</span>(tot_overlap_time <span class="op">~</span><span class="st"> </span></span>
<span id="cb81-18"><a href="pairwise-associations-in-relation-to-traits.html#cb81-18"></a><span class="st">                                          </span>diff_gizzard <span class="op">*</span><span class="st"> </span>tide_stage <span class="op">+</span></span>
<span id="cb81-19"><a href="pairwise-associations-in-relation-to-traits.html#cb81-19"></a><span class="st">                                          </span>(<span class="dv">1</span><span class="op">|</span>tide_number) <span class="op">+</span></span>
<span id="cb81-20"><a href="pairwise-associations-in-relation-to-traits.html#cb81-20"></a><span class="st">                                          </span>(<span class="dv">1</span><span class="op">|</span>uid_pair),</span>
<span id="cb81-21"><a href="pairwise-associations-in-relation-to-traits.html#cb81-21"></a>                                        <span class="dt">data =</span> data_subsample)</span></code></pre></div>
</div>
<div id="aic-and-r2-comparison" class="section level3">
<h3><span class="header-section-number">10.4.2</span> AIC and R<sup>2</sup> comparison</h3>
<p>Compare the AIC weights after looking at the model summaries.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="pairwise-associations-in-relation-to-traits.html#cb82-1"></a><span class="kw">summary</span>(model_time_overlap_full)</span>
<span id="cb82-2"><a href="pairwise-associations-in-relation-to-traits.html#cb82-2"></a></span>
<span id="cb82-3"><a href="pairwise-associations-in-relation-to-traits.html#cb82-3"></a><span class="kw">summary</span>(model_time_overlap_reduced)</span></code></pre></div>
<p>Temporal overlap cannot be explained by the difference in gizzard mass or the difference in behaviour. This is an interesting pattern when taken together with the positive effect of behavioural difference on spatial overlap.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="pairwise-associations-in-relation-to-traits.html#cb83-1"></a><span class="co"># get aic difference</span></span>
<span id="cb83-2"><a href="pairwise-associations-in-relation-to-traits.html#cb83-2"></a><span class="kw">AIC</span>(model_time_overlap_full) <span class="op">-</span><span class="st"> </span><span class="kw">AIC</span>(model_time_overlap_reduced)</span>
<span id="cb83-3"><a href="pairwise-associations-in-relation-to-traits.html#cb83-3"></a></span>
<span id="cb83-4"><a href="pairwise-associations-in-relation-to-traits.html#cb83-4"></a><span class="co"># get R2</span></span>
<span id="cb83-5"><a href="pairwise-associations-in-relation-to-traits.html#cb83-5"></a>MuMIn<span class="op">::</span><span class="kw">r.squaredGLMM</span>(model_time_overlap_reduced)</span></code></pre></div>
</div>
</div>
<div id="save-data-to-file-for-network-analyses" class="section level2">
<h2><span class="header-section-number">10.5</span> Save data to file for network analyses</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="pairwise-associations-in-relation-to-traits.html#cb84-1"></a><span class="kw">write_csv</span>(data_summary, <span class="dt">path =</span> <span class="st">&quot;data/data_pairwise_comparisons.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="finding-networks-from-patch-data-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bathymetry-of-the-griend-mudflats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/knot-association/edit/master/09_pairwise_association.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>

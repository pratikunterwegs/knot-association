
# red knots tracking prelim summary ####

```{r, echo=FALSE, fig.height=12, fig.width=12, message=FALSE, warning=FALSE}

library(tidyverse)
source("codePlotOptions/ggThemePub.r")
```


```{r, echo=FALSE, fig.height=6, fig.width=12, message=FALSE, warning=FALSE}
# load data
data = read_csv("../data2018/data2018posWithTides.csv")

# indivs over time
s0=data %>% group_by(week) %>% summarise(indivs = length(unique(id)))

# plot indivs over time
ggplot(s0)+geom_col(aes(week, indivs), fill=stdGry, col=1)+
  labs(x = "week", y = "individuals", title = "individuals per week")+
  themePub()

# count fixes per id
s1 = count(data, id)

# plot histogram of fixes
ggplot(s1)+geom_histogram(aes(n),fill=stdGry, col=1)+
  labs(x="fixes",title="histogram of fixes: 0.1 Hz")+
  themePub()

# save image
ggsave(filename = "figFixesHist.pdf", width = 12, height = 6)
```

```{r echo=FALSE, fig.height=6, fig.width=12, message=FALSE, warning=FALSE}
# show deployment effect
s2 = count(data, id, releaseWeek = lubridate::week(Release_Date))

# plot histogram of fixes
ggplot(s2)+
  geom_jitter(aes(x = factor(releaseWeek), n))+
  geom_boxplot(aes(x=factor(releaseWeek), y=n), fill = stdGry, alpha = 0.5)+
  labs(x="release week", y = "fixes",title="total fixes ~ release week")+
  themePub()

# save image
ggsave(filename = "figDeploymentOrderEffect.pdf", width = 12, height = 6)
```

```{r echo=FALSE, fig.height=12, fig.width=12, message=FALSE, warning=FALSE, dpi=300}
# show data count over griend
s3 = data %>% 
  mutate(xmean = plyr::round_any(x, 200), ymean = plyr::round_any(y, 200)) %>% 
  count(xmean, ymean)

# load griend
library(sf)
library(viridis)
griend = st_read("../griend_polygon/griend_polygon.shp")

ggplot(griend)+
  geom_tile(data = s3, aes(x = xmean, y= ymean, fill = n), alpha = 1)+
  scale_fill_gradientn(colours = inferno(10), trans="log10")+
  geom_sf(fill="transparent")+
  coord_sf(datum=NA, expand = FALSE)+
  themePubLeg()+
  labs(x="x", y= "y", fill="fixes", title = "N fixes in 200 m squares")

ggsave(filename = "figFixesAroundGriend.pdf", width = 12, height = 12)
```

![](../figs/figPropFixesPerDay.png)

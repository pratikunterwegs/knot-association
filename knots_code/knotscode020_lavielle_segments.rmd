```{r}
source("libs.R")
library(adehabitatLT)

library(segclust2d)

```

```{r load_data}
#load data
load("knots_data/knots01_for_residence_segments.rdata")
```

```{r prep_for_segments}
#'prep as ltraj
data.prep = data %>% dlply("id.ht")
```

```{r segment_lavielle_segclust2d}
#'segment using lavielle
data.seg = data.prep %>%
  map(function(x){
    segmentation(x, lmin = 10, Kmax = 40, type = "behavior", seg.var = "fpt")
  })
```

```{r find_segs}
#'find the segs in data.seg
data.segpaths = data.seg %>%
  map(function(x){
    augment(x)
  })
```

```{r save_data}
save(data.segpaths, file = "knots_data/knots01_segmented.rdata")
```
